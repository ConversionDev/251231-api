spring:
  application:
    name: api-gateway

  profiles:
    active: ${SPRING_PROFILES_ACTIVE:dev}

  # Database 설정 (PostgreSQL - Neon DB)
  datasource:
    url: jdbc:postgresql://${NEON_DEV_HOST}:${NEON_DEV_PORT:5432}/${NEON_DEV_DATABASE}?sslmode=${NEON_DEV_SSL_MODE:require}
    username: ${NEON_DEV_USER}
    password: ${NEON_DEV_PASSWORD}
    driver-class-name: org.postgresql.Driver
    hikari:
      maximum-pool-size: 10
      minimum-idle: 5
      connection-timeout: 30000
      idle-timeout: 600000
      max-lifetime: 1800000

  # JPA 설정
  jpa:
    hibernate:
      ddl-auto: update
    show-sql: false
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect
        format_sql: true
    open-in-view: false

  # Redis 설정 (Upstash)
  data:
    redis:
      host: ${UPSTASH_REDIS_HOST}
      port: ${UPSTASH_REDIS_PORT}
      password: ${UPSTASH_REDIS_PASSWORD}
      ssl:
        enabled: true

server:
  port: 8080

# ============================================================================
# JWT 설정
# ============================================================================
jwt:
  secret: ${JWT_SECRET}
  expiration: ${JWT_EXPIRATION:900000}
  refresh-expiration: ${JWT_REFRESH_EXPIRATION:604800000}

# ============================================================================
# 쿠키 설정 (Refresh Token용)
# ============================================================================
app:
  cookie:
    secure: ${APP_COOKIE_SECURE:false}
    domain: ${APP_COOKIE_DOMAIN:}

# ============================================================================
# OAuth2 소셜 로그인 설정
# ============================================================================

# Kakao OAuth2
kakao:
  rest-api-key: ${KAKAO_REST_API_KEY}
  client-secret: ${KAKAO_CLIENT_SECRET:}
  redirect-uri: ${KAKAO_REDIRECT_URI:http://localhost:8080/auth/kakao/callback}
  authorization-uri: https://kauth.kakao.com/oauth/authorize
  token-uri: https://kauth.kakao.com/oauth/token
  user-info-uri: https://kapi.kakao.com/v2/user/me

# Naver OAuth2
naver:
  client-id: ${NAVER_CLIENT_ID}
  client-secret: ${NAVER_CLIENT_SECRET}
  redirect-uri: ${NAVER_REDIRECT_URI:http://localhost:8080/auth/naver/callback}
  authorization-uri: https://nid.naver.com/oauth2.0/authorize
  token-uri: https://nid.naver.com/oauth2.0/token
  user-info-uri: https://openapi.naver.com/v1/nid/me

# Google OAuth2
google:
  client-id: ${GOOGLE_CLIENT_ID}
  client-secret: ${GOOGLE_CLIENT_SECRET}
  redirect-uri: ${GOOGLE_REDIRECT_URI:http://localhost:8080/auth/google/callback}
  authorization-uri: https://accounts.google.com/o/oauth2/v2/auth
  token-uri: https://oauth2.googleapis.com/token
  user-info-uri: https://www.googleapis.com/oauth2/v2/userinfo

# ============================================================================
# Frontend 설정
# ============================================================================
frontend:
  callback-url: ${FRONTEND_CALLBACK_URL:http://localhost:3000/dashboard}

# ============================================================================
# SpringDoc OpenAPI 설정
# ============================================================================
springdoc:
  api-docs:
    path: /docs/api-docs
    groups:
      enabled: true
  swagger-ui:
    path: /docs
    enabled: true
    operations-sorter: method
    tags-sorter: alpha
    use-root-path: false
    persist-authorization: true
    show-actuator: false
    default-flat-param-object: true
    writer-with-order-by-keys: true
    default-group: all

# ============================================================================
# Actuator 설정
# ============================================================================
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics
  endpoint:
    health:
      show-details: always

# ============================================================================
# 로깅 설정
# ============================================================================
logging:
  level:
    root: INFO
    kanggyeonggu.store: DEBUG
    org.hibernate.SQL: DEBUG
    org.hibernate.type.descriptor.sql.BasicBinder: TRACE
    io.micrometer: WARN
    io.micrometer.core.instrument: WARN
